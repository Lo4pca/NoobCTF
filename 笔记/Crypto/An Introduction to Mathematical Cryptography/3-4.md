# Integer Factorization and RSA

## Exercise 3.4

3. 证明欧拉定理：对于任何满足gcd(a,N)=1的a，有 $a^{\phi(N)}\equiv 1\mod N$

提示：模仿费马小定理的证明（`Theorem 1.24`），但无需像`1.8`那样枚举a的所有倍数，只取所有满足gcd(k,N)=1的ka即可

既然提示都这么说了，开抄（

首先我们假设 $N\nmid a$ ，接着摆出模N意义下a的所有倍数： $a,k_1a,k_2a,...,k_ja$ ，满足 $gcd(k_i,N)=1$ 。这里一共有 $\phi(N)$ 个数，且每个数都是不同的。假如有两个数xa和ya相同，这意味着 $xa\equiv ya\mod N\rightarrow (x-y)a\equiv 0\mod N$ 。 因为前提条件已经说了 $N\nmid a$ ，所以只能是 $N|x-y$ 。但是无论是x还是y都在1到N-1的范围内，因此x-y的差位于-(N-2)到N-2之间。然而这个区域内只有一个0可以被N整除，意味着x=y。我们也可以确定没有数为0，因为任何 $k_i$ 和a都无法被p整除

既然上述 $\phi(N)$ 个数均不重复且模N意义下只能有 $\phi(N)$ 个与N互质的数，我们可以说上述数字就是所有与N互质的数，只是顺序有所不同

现在让我们把这一堆数乘起来。 $k_1ak_2a...k_ja\equiv k_{1'}k_{2'}...k_{j'}\mod N$ 。因为任何 $k_i$ 都与N互质，所以我们可以把它们拿掉，得到 $a^{\phi(N)}\equiv 1\mod N$

## Exercise 3.5

2. 如果p是质数， $\phi(p^2)$ 的值是什么？ $\phi(p^j)$ 呢？证明你推导的计算 $\phi(p^j)$ 的公式是正确的

提示：移除0到 $p^j-1$ 之间包含因子p的数，剩下的数就和p互质了

因为p是质数，所以与p不互质的数只有那些p的倍数： $0,p,2p,...,(p-1)p$ ，正好有p个数。因此 $\phi(p^2)=p^2-p$

 $\phi(p^j)$ 类似。在0到 $p^j-1$ 之间，有 $p^{j-1}$ 个p的倍数，所以 $\phi(p^j)=p^j-p^{j-1}$

3. 让整数M和N满足gcd(M,N)=1。证明 $\phi(MN)=\phi(M)\phi(N)$

第三章了，仍然只有模糊的思路……

对于M,有 $\phi(M)$ 个数与之互质。那么MN中有N个M，自然有 $N\phi(M)$ 个数与M互质。但我们希望结果与N也互质，所以每个M只能提供 $\phi(N)$ 个数进行组合。因此一共有 $\phi(N)\phi(M)$ 个与MN互质的数

找chatgpt要了个CRT相关的证明：

构造同余映射 $f:Z/MNZ\rightarrow Z/MZ\times Z/NZ$ 。因为gcd(M,N)=1，所以CRT保证这是一个双射

Z/MNZ中的可逆元有 $\phi(MN)$ 个，Z/MZ中的可逆元有 $\phi(M)$ 个，Z/NZ中的可逆元有 $\phi(N)$ 个。一个x在Z/MNZ中可逆明显需要x在Z/MZ，Z/NZ中均可逆。再结合f的双射性质，有 $\phi(MN)=|Z/MNZ^{\times}|=|Z/MZ^{\times}|\times|Z/NZ^{\times}|=\phi(M)\phi(N)$

4. 假设 $p_1,p_2,...,p_r$ 为整除N的不同质数。利用`2`和`3`的结论证明:

$$\phi(N)=N\prod_{i=1}^r(1-\frac{1}{p_i})$$

利用唯一分解定理， $N=p_1^{x_1}p_2^{x_2}...p_r^{x_r}$ 。利用`3`的结论， $\phi(N)=\phi(p_1^{x_1})\phi(p_2^{x_2})...\phi(p_r^{x_r})$ 。再用`2`的结论， $\phi(N)=(p_1^{x_1}-p_1^{x_1-1})(p_2^{x_2}-p_2^{x_2-1})...(p_r^{x_r}-p_r^{x_r-1})$ 。变形，得到 $\phi(N)=p_1^{x_1}(1-\frac{1}{p_1})p_2^{x_2}(1-\frac{1}{p_2})...p_r^{x_r}(1-\frac{1}{p_r})=N\prod_{i=1}^r(1-\frac{1}{p_i})$

## Exercise 3.2

设p为质数, $e\geq 1$ , $c\not=0\mod p$ 。考虑下述同余方程：

$$x^e\equiv c\mod p$$

1. 证明如果该方程有解，则它正好有gcd(e,p-1)个不同的解

提示：用原根定理（`Theorem 1.30`）配合扩展欧几里得算法(`Theorem 1.11`)或`Exercise 1.27`

把x和c写成原根的幂次形式： $x\equiv g^a\mod p, c\equiv g^b\mod p$ 。那么 $(g^a)e\equiv g^b\mod p\Rightarrow ae\equiv b\mod p-1$

没有想过怎么用`Theorem 1.11`，因为`Exercise 1.27`的结论就是“同余方程 $ax\equiv c\mod m$ 有gcd(a,m)个不同的解”

2. 对于多少个非零的值 $c\mod p$ ，上述方程有解？

还是`Exercise 1.27`的结论，`1`中的方程仅在gcd(e,p-1)|b时有解。那么一共有 $\frac{p-1}{gcd(e,p-1)}$ 个非零的c使方程有解

## Exercise 3.14

1. 561=3\*11\*17。首先用费马小定理证明对于每个可能的a：
- $a^{561}\equiv a\mod 3$
- $a^{561}\equiv a\mod 11$
- $a^{561}\equiv a\mod 17$

然后解释为什么上述三个同余说明 $a^{561}\equiv a\mod 561$

注意到2，10和16均整除560。根据费马小定理 $a^{p-1}\equiv 1\mod p$ ,对于每个模数，均有 $a^{560}\equiv 1\mod p$ ，即 $a^{561}\equiv a\mod p$

第二步我以为是crt，但是用通用公式组合起来后发现规律不明显。卡在这条死路里很久，直到chatgpt告诉我直接用`Exercise 2.21`的结论就好……

因为3,11和17均整除 $a^{561}-a$ ，且三者两两互素；因此三者的乘积也整除 $a^{561}-a$
 
3. 证明任何卡迈克尔数（Carmichael number）都是奇数

问chatgpt要提示的时候直接剧透了。它说根据Korselt’s criterion，合数n是卡迈克尔数当且仅当：
- n没有平方因子
- 对于每个素因子p|n,都有p-1|n-1

n是偶数意味着n-1是奇数；排除2后所有的p-1都是偶数。偶数没办法整除奇数，因此偶数不可能是卡迈克尔数

4. 证明卡迈克尔数一定是不同质数的乘积

依然不会做，而且chatgpt给我的证明跳了一些步骤我就差点看不懂了……

需要转换思路。不是直接证明命题，而是证明如果一个数含平方因子，一定存在一个a使其不满足卡迈克尔数的性质。这里我们假设n是卡迈克尔数且 $n=p^2m$ ，有 $a\equiv p+1\mod p^2,a\equiv 1\mod m$ 。根据crt可以确定一定有一个a满足上述需求

卡迈克尔数应满足 $a^{n-1}\equiv 1\mod n$ ，又因为 $a\equiv p+1\mod p^2$ ，所以 $(p+1)^{n-1}\equiv 1\mod p^2$ 。用二项式定理展开后得到 $1+(n-1)p\equiv 1\mod p^2\Rightarrow p^2|(n-1)p\Rightarrow p|n-1$

然而前提条件提到p|n。p不可能同时整除n和n-1。因此卡迈克尔数不能包含任何平方因子

## Exercise 3.19

此题的证明可以用`Theorem 3.21`

1. 设N是一个（较大的）整数。Bob在特定范围内选择了一个n，满足 $\frac{1}{2}N\leq n\leq\frac{3}{2}N$ 。如果他多次重复这个过程，证明他选择的数中约有 $\frac{1}{ln(N)}$ 个数是质数。更准确地说，定义 $P(N)=\frac{\frac{1}{2}N和\frac{3}{2}N中的质数}{\frac{1}{2}N和\frac{3}{2}N中的整数}=[整数n在范围\frac{1}{2}N\leq n\leq\frac{3}{2}N内是质数的概率]$ ，然后证明 $lim_{N\rightarrow\infty}\frac{P(N)}{1/ln(N)}=1$

`Theorem 3.21`长得已经和这里的命题很像了。说 $lim_{X\rightarrow\infty}=\frac{\pi(X)}{X/ln(X)}=1$ ， $\pi(X)$ 是 $2\leq p$ < X中质数p的数量。直接套， $\pi(\frac{1}{2}N)\sim\frac{\frac{1}{2}N}{ln(\frac{1}{2}N)},\pi(\frac{3}{2}N)\sim\frac{\frac{3}{2}N}{ln(\frac{3}{2}N)}$ (`~`是渐进等价)。题目中的P(N)约等于 $\frac{\pi(\frac{3}{2}N)-\pi(\frac{1}{2}N)}{N}$ 。目标变成证明 $lim_{N\rightarrow\infty}\frac{\pi(\frac{3}{2}N)-\pi(\frac{1}{2}N)}{N/ln(N)}=1$

最后直接上科技Wolfram alpha（？），得到上述极限确实是1，完成证明

（科技的力量就是伟大啊）

2. 更一般地，固定两个数 $c_1,c_2$ 满足 $c_2$ > $c_1$ > 0。Bob在特定范围内选择的n满足 $c_1N\leq n\leq c_2N$ 。定义 $P(c_1,c_2;N)=[整数n在范围c_1N\leq n\leq c_2N内是质数的概率]$ 。用一个关于N的函数补全下方的式子，使得式子成立：

$$lim_{N\rightarrow\infty}\frac{P(c_1,c_2;N)}{?}=1$$

尝试直接拷贝上一题的思路：

$\pi(c_2N)\sim\frac{c_2N}{ln(c_2N)};\pi(c_1N)\sim\frac{c_1N}{ln(c_1N)}$ 。两者相减得到 $\frac{c_2N}{ln(c_2N)}-\frac{c_1N}{ln(c_1N)}=\frac{c_2N}{ln(c_2)+ln(N)}-\frac{c_1N}{ln(c_1)+ln(N)}$

emmm，假如N趋近于无穷的话，常数项 $ln(c_2)$ 和 $ln(c_1)$ 和零差不多。因此上述式子渐进等于 $\frac{(c_2-c_1)N}{ln(N)}$ ，这个式子也是问号处的答案

## Exercise 3.20

继续之前的练习（`Exercise 3.19`），解释如何从数学角度理解以下陈述

1. 一个随机选择的奇数N有 $\frac{2}{ln(N)}$ 的概率成为质数（随机选择一个偶数，它是质数的概率是多少？）

假如选择了一个数N，在小于等于N的数里面，大概有 $\frac{N}{ln(N)}$ 个质数。也就是说每个数大概有 $\frac{N}{Nln(N)}=\frac{1}{ln(N)}$ 的概率是质数

就差临门一脚了却突然不知道怎么写了……只有一个偶数质数，就是2。看起来乘个2就得到答案了，但是乘2的理由是什么？因为2也有 $\frac{1}{ln(N)}$ 的概率是质数，然后两个 $\frac{1}{ln(N)}$ 相加？

不知道我在写什么，于是我换了个思路。N中大约有一半的数是偶数，这些数都不会是质数；因此 $\frac{N}{ln(N)}$ 个质数都在 $\frac{N}{2}$ 个数里，有 $\frac{\frac{N}{ln(N)}}{\frac{N}{2}}=\frac{2}{ln(N)}$

怎么感觉是硬凑出来的答案……

至于偶数，概率是 $\frac{1}{N/2}$

2. 随机选择一个满足 $N\equiv 1\mod 3$ 的数 N，其为质数的概率为 $\frac{3}{2 ln(N)}$

既然上一道题是通过“某种除法”凑出来的答案，可能这道题也是。我是这么想的，上一道题除以 $\frac{N}{2}$ ，因为把数分成奇数和偶数的方式等同于把数分成数量差不多的两部分。如果把上一道题的数量换成概率也可以凑出答案（毕竟分子分母都除去N），即 $\frac{\frac{1}{ln(N)}}{\frac{1}{2}}=\frac{2}{ln(N)}$

那么这道题用模3将数分成了数量差不多的三部分。因为三部分里模3余0的一定不是质数（当然三除外），所以可能是质数的部分只有 $\frac{2}{3}$ 。于是得到 $\frac{\frac{1}{ln(N)}}{\frac{2}{3}}=\frac{3}{2ln(N)}$

至于为什么能行，我完全不知道。这是非常凑数的（

问了chatgpt，它说这是Dirichlet素数定理。定义 $\pi(x;m,a)$ 为满足 $p\equiv a\mod m$ 且小余等于x的素数p的数量，有 $\pi(x;m,a)\sim\frac{1}{\phi(m)}\frac{x}{ln(x)}$ 。即，素数在模m的可取同余类（即与m互素的类）中是平均分布的（注意到p具体在什么同余类里不重要）

用Dirichlet定理可以得到有 $\frac{1}{\phi(3)}\frac{N}{ln(N)}=\frac{N}{2ln(N)}$ 个质数模3余1；同时一共有 $\frac{N}{3}$ 个数模3余1。因此模3余1的数是质数的概率为 $\frac{\frac{N}{2ln(N)}}{\frac{N}{3}}=\frac{3}{2ln(N)}$

3. 随机选择一个满足 $N\equiv 1\mod 6$ 的数 N，其为质数的概率为 $\frac{3}{ln(N)}$

Dirichlet定理已经把整道题剧透了（

$\pi(N;6,1)\sim\frac{1}{\phi(6)}\frac{N}{ln(N)}=\frac{N}{2ln(N)}$ , $\frac{\frac{N}{2ln(N)}}{\frac{N}{6}}=\frac{3}{ln(N)}$

不过上一小题的“凑数直觉”还能用。模6等于把所有数分成6份，这里面模6余0的自然不是质数；模6余2和模6余4的也不是，因为形如6x+2或6x+4的数一定是2的倍数；模6余3的同样不是，因为6x+3一定是3的倍数。于是可能是质数的同余类只有1和5，占原同余类数量的三分之一。这样就有了 $\frac{\frac{1}{ln(N)}}{\frac{1}{3}}=\frac{3}{ln(N)}$

4. 让 $m=p_1p_2...p_r$ 为不同质数的乘积，k为满足gcd(k,m)=1的整数。要使下列陈述正确，问号处该填入什么数字？为什么？

随机选择一个满足 $N\equiv k\mod m$ 的数 N，其为质数的概率为 $\frac{?}{ln(N)}$

凑数直觉的本质是找到模m的同余类中与m以及m分解出的质因数全部互质的同余类数量。正好题目的式子和之前凑数的式子很像，继续凑出问号处的答案： $\frac{m}{\phi(m)}$

这也是第5小题的答案，Dirichlet定理直接全秒了（

## Exercise 3.21

对数积分函数 Li(X) 定义为 $Li(X)=\int^X_2\frac{dt}{ln(t)}$

1. 证明 $Li(X)=\frac{X}{ln(X)}+\int^X_2\frac{dt}{ln^2(t)}+O(1)$

提示：分部积分

非常好提示，除了我根本没学会过分部积分（

假设要求两个函数的乘积的积分 $\int u(t)v'(t)dt$ 。根据求导公式 $\frac{d}{dt}[u(t)v(t)]=u'(t)v(t)+u(t)v'(t)$ ，两边对t积分就能得到 $\int\frac{d}{dt}[u(t)v(t)]dt=\int u'(t)v(t)dt+\int u(t)v'(t)dt$ 。积分和求导互为逆操作，变形后就得到了分部积分公式 $\int u(t)v'(t)dt=u(t)v(t)-\int u'(t)v(t)dt$

但是这样太拗口了，于是我们简化一下：
- u=u(t)
- dv=v'(t)dt
- du=u'(t)dt
- v=v(t)

这样就有了 $\int udv=uv-\int vdu$ 。好的，那么该怎么决定谁是u谁是v？有个LIATE表格来决定u的优先级：
| 顺序 | 类型                           | 示例                       |
| -- | ---------------------------- | ------------------------ |
| L  | Logarithmic（对数函数）            | $(\ln x), (\log x)$        |
| I  | Inverse trigonometric（反三角函数） | $(\arctan x), (\arcsin x)$ |
| A  | Algebraic（代数函数）              | $(x^2), (x)$               |
| T  | Trigonometric（三角函数）          | $(\sin x), (\cos x)$       |
| E  | Exponential（指数函数）            | $(e^x), (a^x)$             |

选择u的优先级从高到低，剩下的另一个函数就是v。先看个例子： $\int xe^xdx$

因为代数函数x在这里的优先级最高，所以x是函数u。自然地 $e^xdx$ 对应dv。du=u'(x)dx，而x的导数是1，因此du=dx。 $v=\int e^xdx=e^x$

然后直接代入即可：
- $\int udv=uv-\int vdu$
- $\int xe^xdx=xe^x-\int e^xdx=xe^x-e^x+C$

这个法则对定积分也有效，只是要注意加上下限

回到原来的题目。 $\int^X_2\frac{dt}{ln(t)}$ 可以拆成 $\int^X_2\frac{1}{ln(t)}\times 1dt$ 。此处 $\frac{1}{ln(t)}$ 是u，1dt=dt=dv。 $du=-\frac{1}{tln^2(t)}dt$ ,v=t。拼起来： $\int^X_2\frac{dt}{ln(t)}=[\frac{t}{ln(t)}]^X_2-\int^X_2-\frac{dt}{ln^2(t)}=\frac{X}{ln(X)}-\frac{2}{ln2}+\int^X_2\frac{dt}{ln^2(t)}$ 。因为 $-\frac{2}{ln2}$ 是常数项，不随X的变化而变化，所以可以写成O(1)

2. 计算极限

$$lim_{x\rightarrow\infty}\frac{Li(X)}{X/ln(X)}$$

提示： 将`1`中的积分分解为两部分， $2\leq t\leq\sqrt{X}$ 和 $\sqrt{X}\leq t\leq X$ ，并分别估计每一部分

带积分函数的极限。完全在我的知识盲区里

问了chatgpt。它说积分函数的极限问题需要分段分析被积函数在不同区间的贡献大小，因为积分函数有个“累加”的概念。其余思路和求普通函数的极限的思路相通

普通函数求极限时看的是它的函数值，即y的大小；而积分函数的结果简单理解是函数值与x轴之间的面积。可以看出对于积分函数来说，当y值变大后，即使y值只增加一点，其积分函数的结果也会增加很多；这点与普通函数不一致。分段区域指的是找出一个分界处，分界处后的y已经大到超过了一个阈值，使得小小的增加也会引发较大的积分函数值增加

普通函数就没这么多说法了。它的函数值就是当前这点的值，和之前的值是多少一点关系也没有，区别于积分函数的整体行为

至于该如何分段，肯定要把贡献小甚至看不出来的部分与贡献大的部分分开。大贡献区域一般有三种情况：
- 函数值虽然小但是区间很长（高度低但是长度长）
- 函数值变大，自然大部分的面积贡献都集中在函数值较大的区域
- 综合作用，大概是以上两者的结合

提示已经找好分界点了， $\sqrt{X}$ 。可以在desmos中画出这个函数，能发现在这个点之前的部分中， $\frac{1}{\ln^2(t)}$ 的最大值是 $\frac{1}{\ln^2(2)}$ ，尔后逐步减小，长度只有 $\sqrt{X}$ 。后半部分虽然高度很低，但长度更长（上文的第一种情况），是两个区域中占据积分函数主导部分的区域

接下来算后半部分比 $\frac{X}{ln(X)}$ 的极限。这段有 $t\geq\sqrt{X}$ ，因此 $ln(t)\geq ln(\sqrt{X})=\frac{1}{2}ln(X)$ 。于是被积函数有上界 $\frac{1}{\ln^2(t)}\leq\frac{1}{(\frac{1}{2}ln(X))^2}=\frac{4}{ln^2(X)}$ 。因为积分区域是 $\sqrt{X}$ 到X，所以区间长度为 $X-\sqrt{X}$ ( $\int_{\sqrt{X}}^X dt$ 的值)。长和高相乘得到面积的上界 $\frac{4(X-\sqrt{X})}{ln^2(X)}$ ,与 $\frac{X}{ln(X)}$ 的比值为 $\frac{4}{ln(X)}\frac{X-\sqrt{X}}{X}$ ，随着分母X的不断变大收敛到0

下界也可以用类似的原理去求，得到 $\frac{X-\sqrt{X}}{ln^2(X)}$ ，同样比值收敛到0。前后两个部分的极限都是0，那么整个积分函数比 $\frac{X}{ln(X)}$ 的极限也是0

最后Li(X)只剩下 $\frac{X}{ln(X)}$ 部分，毕竟不用管O(1)。可得出：

$$lim_{x\rightarrow\infty}\frac{Li(X)}{X/ln(X)}=1$$

3. 利用`2`说明公式`3.12`:

$$\pi(X)=\int^X_2\frac{dt}{ln(t)}+O(\sqrt{X}ln(X))$$

蕴含（implies）了素数定理（`Theorem 3.21`）：

$$\lim_{X\rightarrow\infty}\frac{\pi(X)}{X/ln(X)}=1$$

$O(\sqrt{X}ln(X))$ 表示存在某个大于0的常数C，以及某个足够大的 $X_0$ ，使得对所有X > $X_0$ 都有: 

$$|\pi(X)-\int^X_2\frac{dt}{ln(t)}|\leq C\sqrt{X}ln(X)$$

意思是无论误差如何变化，其最大增长速度都不会超过 $\sqrt{X}ln(X)$ 。一个关键的地方在于 $lim_{X\rightarrow\infty}\frac{\sqrt{X}ln(X)}{X/ln(X)}=\frac{ln^2(X)}{\sqrt{X}}=0$ ，所以整个 $\frac{\pi(X)}{X/ln(X)}$ 起作用的只有那个积分部分，已在`2`中已经证明过整体的极限是1

## Exercise 3.32

此题要求证明`Corollary 3.45`的一个论断。让 $L(X)=e^{\sqrt{ln(X)ln(ln(X))}}$

1. 证明存在一个大于0的 $\epsilon$ ，满足 $ln(X)^{\epsilon}$ < ln(L(X)) < $ln(X)^{1-\epsilon}$ , $\forall X$ > 10

首先让 $y=ln(X)$

$ln(L(X))=\sqrt{yln(y)}=(yln(y))^{\frac{1}{2}}$ 。问题变为 $y^{\epsilon}$ < $(yln(y))^{\frac{1}{2}}$ < $y^{1-\epsilon}$

一个很明显的渐进行为是 $\frac{ln(ln(x))}{ln(x)}\rightarrow 0(x\rightarrow\infty)$ ，意味着 $ln(y)^{\frac{1}{2}}$ 相对于 $y^{\sigma}$ （ $\sigma$ 大于0）增长很慢。对于足够大的y， $y^{\frac{1}{2}}$ 可以“吸收” $ln(y)^{\frac{1}{2}}$

所以只要让 $\epsilon$ < $\frac{1}{2}$ ，上述不等式的下界自然在y足够大的时候满足（还需要进一步证明“足够大的y”指的是X大于10）

对于上界，可以写成 $ln(y)^{\frac{1}{2}}$ < $y^{\frac{1}{2}-\epsilon}$ 。两边取对数可以得到 $\frac{1}{2}ln(ln(y))$ < $(\frac{1}{2}-\epsilon)ln(y)$ 。明显只要 $\epsilon$ < $\frac{1}{2}$ 且y足够大时，不等式一定成立

然后证对 X > 10均成立的部分

继续变形原不等式的下界，从而找到X的临界值对应的 $\epsilon$ 。 $y^{\epsilon}$ < $(yln(y))^{\frac{1}{2}}$ $\Leftrightarrow y^{\frac{1}{2}-\epsilon}ln(y)^{\frac{1}{2}}$ > 1。让 $f(y)=y^{\frac{1}{2}-\epsilon}ln(y)^{\frac{1}{2}}$ 。只要 $\epsilon$ < $\frac{1}{2}$ ，函数就是单调递增的，最小值出现在y=ln(10)。用desmos画一下图（或者代入y=ln(10)算），可以得到 $\epsilon$ 的一个上界，为0.39左右

接着变形原不等式的上界。 $\frac{1}{2}ln(ln(y))$ < $(\frac{1}{2}-\epsilon)ln(y)\Leftrightarrow\epsilon$ < $\frac{1}{2}-\frac{ln(ln(y))}{2ln(y)}$ 。为了对所有 $y\geq 10$ 成立，我们需要找出最大的下界，即 $\epsilon$ < $inf_{y\geq ln(10)}(\frac{1}{2}-\frac{ln(ln(y))}{2ln(y)})=\frac{1}{2}-\frac{1}{2}sup_{y\geq ln(10)}(\frac{ln(ln(y))}{ln(y)})$ (sup指最小的上界)

（这块有个公式：

- $inf_x(a-bf(x))=a-bsup_x(f(x))$
- $sup_x(a-bf(x))=a-binf_x(f(x))$

）

利用导数分析可以得到 $q(y)=\frac{ln(ln(y))}{ln(y)}$ 的最大值是 $\frac{1}{e}$ ，位于 $y=e^e$ 处。因此 $sup_{y\geq ln(10)}q(y)\leq\frac{1}{e}$ 。于是对于所有 $y\geq ln(10)$ 都有 $\epsilon$ < $\frac{1}{2}-\frac{1}{2e}\approx 0.3164...$

只要取 $\epsilon\approx 0.3164...$ ，它就能在 $y\geq ln(10)$ 时对原不等式的上下界成立。完成证明

（又是chatgpt代打的一天）

2. 假设c大于0， $Y=L(X)^c,u=\frac{ln(X)}{ln(Y)}$ 。证明：

$$u^{-u}=L(X)^{-\frac{1}{2c}(1+o(1))}$$

chatgpt说遇到这类题不要直接以幂乘方式比较（即不要硬拆），用对数将复杂问题变成加法和乘法后会简单一点。比如 $u^{-u}=exp(-uln(u))$ （exp(t)指 $e^t$ ）。此时原问题变为证明 $-uln(u)=-\frac{1}{2c}(1+o(1))ln(L(X))$

接下来引入等式帮助计算。设 $A=ln(X),B=ln(A)=ln(ln(X))$ 。这样设A和B的话就能利用L(X)的定义得出 $ln(L(X))=\sqrt{AB}$

题目说 $Y=L(X)^c$ ，所以 $ln(Y)=c\sqrt{AB}$ 。因此 $u=\frac{ln(X)}{ln(Y)}=\frac{A}{c\sqrt{AB}}=\frac{1}{c}\sqrt{\frac{A}{B}}$

离uln(u)还差个ln(u)，那么下一步就是算 $ln(u)=ln(\frac{1}{c}\sqrt{\frac{A}{B}})=-ln(c)+\frac{1}{2}ln(A)-\frac{1}{2}ln(B)=-ln(c)+\frac{1}{2}B-\frac{1}{2}ln(B)$

这下就能拼 $uln(u)=\frac{1}{c}\sqrt{\frac{A}{B}}(-ln(c)+\frac{1}{2}B-\frac{1}{2}ln(B))$ 了。根据每项增长速度的量级决定出主项 $(\frac{1}{c}\sqrt{\frac{A}{B}})(\frac{1}{2}B)=\frac{1}{2c}\sqrt{AB}=\frac{1}{2c}ln(L(X))$

剩下的两项的增长速度完全比不上 $\sqrt{AB}$ 的增长速度（当X趋近于无穷时，次级项比主项的比值为0），因此剩下的两项可直接归为o(1)

最后加个负号就有了 $-uln(u)=-\frac{1}{2c}(1+o(1))ln(L(X))$ ,完成证明

## Exercise 3.30

证明函数 $L(X)=e^{\sqrt{ln(X)ln(ln(X))}}$ 是次指数级（subexponential）；即，证明以下两条结论：

1. 对于每个大于0的常数 $\alpha$ ，无论多大， $L(X)=\Omega(ln(X)^{\alpha})$

这本书里的order notation均遵循计算机科学里的定义。 $f(X)=\Omega(g(X))$ 表示存在一个大于0的常数c和C，满足 $f(X)\geq cg(X),\forall X\geq C$

设 $y=ln(ln(X))$

取个对数，把问题化成 $\sqrt{\frac{ln(X)}{y}}\geq\alpha$ (省略常数项ln(c))，即 $\frac{ln(X)}{y}\geq\alpha^2$ 。当 $X\rightarrow\infty,\frac{ln(X)}{y}\rightarrow \infty$ ,所以自然存在某个 $X\geq C$ 使得不等式成立

2. 对于每个大于0的常数 $\beta$ ，无论多小， $L(X)=O(X^{\beta})$

$f(X)=O(g(X))$ 表示存在一个大于0的常数c和C，满足 $f(X)\leq cg(X),\forall X\geq C$

仿照上一小题， $\sqrt{ln(X)y}\leq \beta ln(X)+ln(c)\Rightarrow\sqrt{\frac{y}{ln(X)}}\leq\beta+\frac{ln(c)}{ln(X)},\forall X\geq C$ 。因为 $\sqrt{\frac{y}{ln(X)}}$ 在X趋近于无穷时趋近于0，所以左边一定小于等于右边。如果留出一个余量，比如 $\frac{\beta}{2}$ ，我们还可以算出c的可能取值： $\frac{\beta}{2}\leq\beta+\frac{ln(c)}{ln(X)}$ ， $\frac{ln(c)}{ln(X)}$ 一定大于0，因此选c=1就够了

## Exercise 3.33

`Proposition 3.48`的结论假设我们随机选择整数 $a\mod N$ ，计算 $a^2\mod N$ 后检查结果是否为B光滑数。但更好的结论可以通过选 $a=\lfloor\sqrt{N}\rfloor+k,1\leq k\leq K$ 得到

（可以将K视为与N无关的固定整数。更严格地说，需要取K等于L(N)的幂，但这对最终答案的影响很小）

1. 证明 $a^2-N\leq 2K\sqrt{N}+K^2$ 。因此有 $a^2\mod N$ 小于 $\sqrt{N}$ 的倍数（so in particular, $a^2\mod N$ is smaller than a multiple of $\sqrt{N}$ ）

$(\sqrt{N}+k)^2=N+2k\sqrt{N}+k^2$ 。因为 $\lfloor\sqrt{N}\rfloor\leq\sqrt{N}$ ，所以 $a^2\leq N+2k\sqrt{N}+k^2$ 。又因为 $k\leq K$ ，所以 $a^2-N\leq 2K\sqrt{N}+K^2$

2. 通过证明：

$$lim_{N\rightarrow\infty}\frac{log(L(\sqrt{N}))}{log(L(N)^{\frac{1}{\sqrt{2}}})}=1$$

说明 $L(\sqrt{N})\approx L(N)^{\frac{1}{\sqrt{2}}}$

更一般地，用同样的方式证明对任意固定的正数r，有 $L(N^{\frac{1}{r}})\approx L(N)^{\frac{1}{\sqrt{r}}}$

让 $A=ln(N),B=ln(A)=ln(ln(N))$ 。套一下L(X)的定义：
- $log(L(\sqrt{N}))=\sqrt{\frac{1}{2}A(ln(\frac{1}{2})+B)}log(e)$
- $log(L(N)^{\frac{1}{\sqrt{2}}})=\frac{1}{\sqrt{2}}\sqrt{AB}log(e)$

注意到两个log(e)可以互相抵消，第一个式子的 $\sqrt{\frac{1}{2}}$ 可以拆出来变成 $\frac{1}{\sqrt{2}}$ ，因此最后要比较的只有 $\sqrt{A(ln(\frac{1}{2})+B)}$ 和 $\sqrt{AB}$ 。 $ln(\frac{1}{2})$ 在N趋近于无穷时无足轻重，因此两者可以看作是同阶的

换成任意的r也不会改变上述结论（但某种意义上可以说r越大两者越接近？），代数过程也差不多

3. 用上述a的更优取值重新证明`Proposition 3.48`。设 $B=L(N)^c$ 并求出c的最优值。分解N大概需要多少组关系？

（看书时完全没看懂`Proposition 3.48`的证明。本来想糊弄过去的，没想到课后习题考了……）

做之前得记录一下169页下方出现的一段我一时没反应过来的内容：

In order to perform the linear equation elimination step, we need (at least) as many B-smooth numbers as there are primes less than B. We need this many because in the elimination step, the smooth numbers correspond to the variables, while the primes less than B correspond to the equations, and we need more variables than equations. 

“变量比方程更多”？解线性方程不应该要求方程比变量多吗？往上翻到162页的示例，分解算法的内容大概如下：由于 $a^2-b^2=(a+b)(a-b)$ ,所以可以通过寻找满足 $c\equiv a_i^2\mod N$ 且c是B-光滑数的多个 $c_i$ ，然后假设每个 $c_i=p_1^{e_{r1}}p_2^{e_{r2}}...p_t^{e_{rt}}$ ，用linear equation elimination找到 $u_1,u_2,...,u_r$ 使 $c_1^{u_1}c_2^{u_2}...c_r^{u_r}$ 的结果是完全平方数，进而用gcd概率性地分解N

结果是完全平方数意味着其质因数分解结果中的每个质因数对应的幂次都是2的倍数，即求解t个形如 $e_{1t}u_1+e_{2t}u_2+...+e_{rt}u_r\equiv 0\mod 2$ 的方程

这里可以看出小于B的质数数量对应方程的数量；B光滑数的数量对应变量的数量，与上文吻合。然后就到了关键的地方：Ax=b和Au=0背后的数学意义完全不一样。我以为Au=0是Ax=b中b=0的特殊情况，然而Ax=b是在求“这个方程是否有解，以及是什么解”;Au=0是在求“这个矩阵是否有线性依赖”。矩阵只在两种情况下会出现线性依赖：
- 向量数量超过矩阵维度
- 矩阵自身包含线性相关向量

放到这题的背景下，“向量数量”对应矩阵列向量的数量，即B光滑数的数量；维度则是行向量的数量，即小于B的质数数量

（只需要弄清楚这里不是在解方程而是在找线性相关的非平凡组合就好了。线性代数全忘光的后果）

接下来开始抄原书的证明（

从`1`中得知a的取值的最大量级大概是 $M\asymp K\sqrt{N}$ ( $f(x)\asymp g(x)$ 表示存在两个与x无关的正数 $C_1,C_2$ ，使得当 $x\rightarrow\infty$ 时， $C_1g(x)\leq f(x)\leq C_2g(x)$ )。这样的随机数是光滑数的概率为 $\frac{\psi(M,B)}{M}$ ( $\psi(X,B)$ 表示满足1 < n $\leq X$ 的B光滑数n的数量)。那么找到 $\pi(B)$ 个B光滑数需要检查大概 $\frac{\pi(B)}{\psi(M,B)/M}$ 个数

`2`的结论是 $L(N^{\frac{1}{2}})\approx L(N)^{\frac{1}{\sqrt{2}}}$ ，那么将等号右边开 $\frac{1}{\sqrt{2}}$ 次根就得到了 $L(N)\approx L(N^{\frac{1}{2}})^{\sqrt{2}}$ 。再利用`Corollary 3.45`的结论可得到 $\psi(M,B)\approx\psi(\sqrt{N},L(N)^c)\approx\psi(\sqrt{N},L(\sqrt{N})^{c\sqrt{2}})=\sqrt{N}\*L(\sqrt{N})^{-(1/(2c\sqrt{2}))(1+o(1))}$ ，于是 $\psi(M,B)/M\approx L(\sqrt{N})^{-(1/(2c\sqrt{2}))}\approx L(N)^{-\frac{1}{4c}}$

众所周知 $\pi(B)\approx\frac{B}{ln(B)}$ ，那么 $\frac{\pi(B)}{\psi(M,B)/M}\approx\frac{B/ln(B)}{L(N)^{-\frac{1}{4c}}}=\frac{L(N)^c}{cln(L(N))}\frac{1}{L(N)^{-\frac{1}{4c}}}=L(N)^{c+\frac{1}{4c}}\frac{1}{cln(L(N))}$

第一个项占主导，因此目标是最小化 $c+\frac{1}{4c}$ 。这个函数的导数是 $1-\frac{1}{4c^2}$ ，在 $c=\frac{1}{2}$ 时等于0。这就是我们要找的最小值

把这个值代回原式并只考虑主导项，得到 $\frac{\pi(B)}{\psi(M,B)/M}\approx L(N)$

（感觉抄都没抄明白……总之一股脑全 $\approx$ 就莫名其妙地完事了）

## Exercise 3.40

假设p为奇质数， $g,h\in F_p^{\*}$ ,g为原根。将p-1写为 $2^sm$ ，其中m为奇数， $s\geq 1$ 。 $log_g(h)$ 的二进制展开式为：

$$log_g(h)=\epsilon_0+2\epsilon_1+4\epsilon_2+8\epsilon_3+...$$

其中 $\epsilon_0,\epsilon_1...\in$ {0,1}

作为`Example 3.69`的推广，请给出一个高效计算 $\epsilon_0, \epsilon_1,...,\epsilon_{s-1}$ 的算法，从而证明离散对数的前s位是不安全的
- 可以利用`Exercise 3.39`的结论：如果 $p\equiv 3\mod 4$ ,存在高效的算法计算 $F_p^{\*}$ 中的平方根
- 提示：用`Example 3.69`计算第0个bit，然后求h或者 $g^{-1}h$ 的平方根；重复以上步骤

假设已经用`Example 3.69`确定了 $\epsilon_0$ ，然后具体分析 $\epsilon_0$ 的两种情况：
- 0，意味着 $log_g(h)$ 是偶数，即 $h=g^{2x}$ 。那么我们开一个平方根，对x做二进制展开。展开的结果正好等于原二进制展开式的“一半”，这个新展开式的 $\epsilon_0$ 是原展开式的 $\epsilon_1$ ，可以用`Example 3.69`确定
- 1，意味着 $log_g(h)$ 是奇数，即 $h=g^{2x+1}=g^{2x}g$ 。把这个结果乘上一个 $g^{-1}$ 取消掉右边的g，接下来就和上一种情况一样了

现在出现了几个问题：
- 为什么上述过程正好能重复s次？
- p不一定满足 $p\equiv 3\mod 4$ ，进而无法完成“开平方根”这一步
- 以上两点是否有什么关系？

假设 $log_g(h)=x$ ，意味着 $h=g^x$ 。给这个式子多乘一个 $g^{p-1}$ 不会改变其结果，因此 $h=g^{2^sm+x}$ 。从这里就能看出最多能开s次平方根：
- 如果x是偶数，可以直接约出一个2
- 如果x是奇数，乘上 $g^{-1}$ 将其“变成”偶数后同样能约出一个2
- 最后只剩下m后无论如何都无法凑出偶数了

但是这样就很奇怪。如果s=1，则p模4同余3，没有问题；然而所有大于等于2的s都说明了原始的p模4等于1，不存在高效的算法开平方根，进而得不到 $\epsilon_i$

事实证明出题人给提示时最好给完，不然我一定会在莫名其妙的地方翻车（

如果 $p\equiv 1\mod 4$ ，可以用Tonelli–Shanks算法（我还抄过，完全忘了）找平方根，所以那个困扰我的问题根本就不存在

（不对出题人好像给完提示了，我又仔细看了一遍原文内容，说的是"as provided for example by Exercise 3.39",这个"for example"就很关键……）

最后是一个延伸的平方根的结论：群中元素是否能被连续开平方，本质上受群阶中 2 的幂 $2^s$ 的数量s限制

## Exercise 3.10

对所有与N互质的整数a，RSA公钥(N,e)的解密指数是满足 $a^{de}\equiv a\mod N$ 的整数d

1. 假设Eve有一个魔盒，可以为一组(N,e)生成解密指数。其中N为固定模数，e为大量不同的加密指数。解释Eve如何用她的魔盒分解N

$ed-1\equiv 0\mod (p-1)(q-1)$ 。假设有一组e和d和e'与d'，ed-1和e'd'-1分别等于 $k\phi(N)$ 和 $k'\phi(N)$ 。运气好的话两者的gcd可以直接给出 $\phi(N)$ （不过很多时候k和k'之间也存在gcd，所以要多组值），进而与N一起构造一元二次方程解出p和q

但是这不完全对。回顾`Remark 3.6`的内容，这题描述的d与e的关系还有可能是 $ed-1\equiv 0\mod\lambda(N)$ ，其中 $\lambda(N)=\frac{\phi(N)}{gcd(p-1,q-1)}$

假设gcd后拿到的结果为T。gcd(p-1,q-1)一定是偶数，且通常不会太大；因此我们从 $T=\frac{\phi(N)}{2}$ 开始假设，计算N-2T+1。如果猜测正确的话，这个值将是p+q，进而构造方程计算p和q；如果不正确，则换一个值重复上述步骤

如果觉得单纯爆破太慢了，可以从“p和q大小差不多”这点入手，得到 $N-kT+1\approx 2\sqrt{N}$ ，意味着 $k\approx \frac{N+1-2\sqrt{N}}{T}$

## Exercise 3.11

以下是一个密码系统的加解密过程：

Alice选择两个大素数p和q，并发布N=pq。假设N难以分解。Alice额外选择三个随机数g、 $r_1$ 和 $r_2$ ，并计算：
- $g_1\equiv g^{r_1(p-1)}\mod N$
- $g_2\equiv g^{r_2(q-1)}\mod N$

她的公钥是 $(N,g_1,g_2)$ ，私钥是(p,q)。接下来Bob选择他要发送的整数m，用两个随机数 $s_1,s_2$ 计算 $c_1\equiv mg_1^{s_1}\mod N,c_2\equiv mg_2^{s_2}\mod N$ ，密文对是 $(c_1,c_2)$

解密过程极其简单。Alice利用CRT求解下列同余方程组：
- $x\equiv c_1\mod p$
- $x\equiv c_2\mod q$

1. 证明解x与m相同

$c_1\equiv mg^{r_1(p-1)s_1}\mod p$ ，由于 $g^{p-1}\equiv 1\mod p$ ， $c_1\equiv m\mod p$ 。模q的情况类似

2. 解释为什么这个密码系统不安全

盯了半天没头绪，偷瞄了一眼solution后才发现我似乎和这个系统的发明人犯了一个错误：把事情想得太复杂了

根据 $g_1$ 的定义， $g_1\equiv 1\mod p$ ，也就是说 $g_1-1$ 是p的倍数（不太可能同时也是q的倍数）。直接 $gcd(g_1-1,N)$ 很有可能直接得到p

就这么简单……

## Exercise 3.16

回顾`Exercise 3.10`，这题假设魔盒只能输出一个解密指数。说明如何利用Miller–Rabin素数测试的思想分解N

终于见到了这个CTF里非常经典的RSA结论。不过我一直在抄脚本，根本没自己想过……

$m^{ed}\equiv m\mod n$ ，那么 $m^{ed-1}\equiv 1\mod p$ 。Miller–Rabin的关键结论是`Proposition 3.17`，说如果p是质数且 $p-1=2^kq$ ，则要么 $a^q\equiv 1\mod p$ ，要么存在一个数j，使得 $a^{2^jq}\equiv -1\mod p$ （j小于k，不然直接就 $a^{p-1}\equiv 1\mod p$ 了）

$ed-1=k(p-1)$ ，于是仿照Miller–Rabin，把ed-1分解成 $2^{k'}q'$ 后随机选一个a计算 $a^{q'}$ 。运气好的话可以直接 $gcd(a^{q'}-1,N)$ 分解出p，否则逐个计算 $gcd(a^{2^iq}+1,N)$ ，也有可能得到p。如果什么都得不到，说明这个a是一个witness，换一个a重复以上步骤即可

（此处完全忽略了q的情形。如果p和q对于同一个 $a^{2^iq}$ 均同余1或-1，则gcd会得到N）

至于为什么k倍的p-1能用同样的结论，我想是因为上述构造的关键点只有：
- $a^x\equiv 1\mod p$ ,x是什么不重要
- 平方根链

只要这两点符合，那么原证明的论述就全都正确

## Exercise 3.23

称形如 $2^n-1$ 的素数为梅森素数（Mersenne prime）

3. 如果n是偶数且n > 2，证明 $2^n-1$ 不是质数

如果n是偶数，意味着n=2x。原式等于 $(2^x)^2-1$ 。利用 $a^2-b^2=(a+b)(a-b)$ 即可分解

4. 如果3|n且n > 3，证明 $2^n-1$ 不是质数

立方差公式 $a^3-b^3=(a-b)(a^2+ab+b^2)$

5. 如果n是合数，证明 $2^n-1$ 不是质数

这题想了我好久，因为证明一个数不是质数的方法很少（至少目前学过的方法很少）。要么给出分解，要么给出一个整除n的数字，或者Miller–Rabin测试？然而这些方法都没法用，因为数值不确定且不好分类（模某个数——比如4——也看不出来什么东西）

我一度怀疑我前两题是不是用的非预期解，因为这题没法无脑套公式了

……吗？

看了solutions后发现这个世界上存在n次方差(n次方和也有)公式，又名[等幂和差](https://zh.wikipedia.org/wiki/%E7%AD%89%E5%B9%82%E5%92%8C%E5%B7%AE)。我的基础还是太差了

## Exercise 3.28

如果所有整除M的质数幂均满足 $p^e\leq B$ ，则称M是B幂光滑数（B-power-smooth）

4. 证明M是B幂光滑数当且仅当M整除lcm(1,2,...,B)

如果 $p^{x+1}\leq B$ ，自然 $p^x\leq B$ 。由此我们可以断言M的所有质因数幂均在[1,2,...,B]的列表中。由于找列表的最小公倍数等于:
- 找列表中的每一个数的质因数分解
- 找列表中全部质因数分解中不重复的质数
- 取所有不重复的质数幂最高的那一项相乘

因此必然有M|lcm(1,2,...,B)

## Exercise 3.31

对于任意固定的正数常数a和b，定义函数:

$F_{a,b}(X)=e^{ln(X)^{\frac{1}{a}}ln(ln(X))^{\frac{1}{b}}}$

证明 $F_{a,b}(X)$ 的下列性质：

1. 如果a > 1， $F_{a,b}(X)$ 是次指数级

次指数级的定义在169页（`Exercise 3.30`见过但我忘了）：

$\forall\alpha,\beta$ > 0,无论 $\alpha$ 有多大， $\beta$ 有多小，有 $\Omega(ln(X)^{\alpha})=f(X)=O(X^{\beta})$

（我真的不会做这类题，而且solution manual总是没有这类题的解析……只能让chatgpt来了）

次指数级的定义等价为：对任意固定的正数 $\alpha,\beta$ ，都存在常数 $c_1,c_2$ （依赖于 $\alpha,\beta,a,b$ ），使得当X足够大时， $c_1ln(X)^{\alpha}\leq F_{a,b}(X)\leq c_2X^{\beta}$

先看下界，第一步是取对数,原题等价于证明 $ln(X)^{\frac{1}{a}}ln(ln(X))^{\frac{1}{b}}\geq\alpha ln(ln(X))+ln(c_1)$

接下来用两个式子的主导项做个分式： $\frac{ln(F_{a,b}(X))}{ln(ln(X))}=ln(X)^{\frac{1}{a}}ln(ln(X))^{\frac{1}{b}-1}$ 。为了求极限，再取一个对数得到 $\frac{1}{a}ln(ln(X))+(\frac{1}{b}-1)ln(ln(ln(X)))$ 。当X趋近于无穷时，该式也趋近于无穷。因此存在 $X_0$ ，使得当X > $X_0$ 时， $ln(X)^{\frac{1}{a}}ln(ln(X))^{\frac{1}{b}-1}\geq\alpha$ ,两边乘上ln(ln(X))即可得到 $ln(X)^{\frac{1}{a}}ln(ln(X))^{\frac{1}{b}}\geq\alpha ln(ln(X))$

求上界的第一步仍然是取对数。 $ln(c_2X^{\beta})=\beta ln(X)+ln(c_2)$ 。主项是ln(X)，那么构造的分式为 $\frac{ln(F_{a,b}(X))}{ln(X)}=ln(X)^{\frac{1}{a}-1}ln(ln(X))^{\frac{1}{b}}$ 。由于a > 1，指数 $\frac{1}{a}-1$ 一定小于0，所以我们只考虑后面的 $ln(ln(X))^{\frac{1}{b}}$

假设对于任意给定的大于0的 $\epsilon$ ，在X足够大时有 $ln(ln(X))\leq ln(X)^{\epsilon}$ ，那么也有 $ln(ln(X))^{\frac{1}{b}}\leq ln(X)^{\frac{\epsilon}{b}}$ ，进而有 $\frac{ln(F_{a,b}(X))}{ln(X)}\leq Cln(X)^{\frac{1}{a}-1+\frac{\epsilon}{b}}$ (C为某个常数)。如果选取的 $\epsilon$ 满足 $\frac{1}{a}-1+\frac{\epsilon}{b}$ 小于0，那么整个分式就会在X趋近于无穷时趋近于0，说明 $F_{a,b}(X)\leq c_2X^{\beta}$

（这里有个知识点， $lim_{X\rightarrow\infty}\frac{ln(ln(X))}{ln(X)^{\epsilon}}=0,\forall\epsilon$ > 0。所以无论 $\epsilon$ 多小，一定可以找到一个 $X_0$ ，使得对所有大于 $X_0$ 的X，都有 $ln(ln(X))\leq ln(X)^{\epsilon}$ ）

2. 如果a=1，证明 $F_{a,b}(X)=\Omega(X^{\alpha}),\forall\alpha$ > 0。这说明 $F_{a,b}(X)$ 的增长速度快于任何一个指数函数，称其是超指数增长（superexponential growth）

此时 $\frac{ln(F_{a,b}(X))}{ln(X)}=ln(ln(X))^{\frac{1}{b}}$ 。b固定，且当 $X\rightarrow\infty$ 时， $ln(ln(X))\rightarrow\infty$ ，因此 $F_{a,b}(X)$ 的增长速度远超 $X^{\alpha}$

（这种题是我目前做起来最难受的一类题……我毫无基础，solutions manual没东西，而且我不确定chatgpt会不会把我带沟里……）

（它真带了我也看不出来）

## Exercise 3.37

假设p为奇质数，a为整数且 $p\nmid a$

2. 证明 $a^{\frac{p-1}{2}}\equiv 1\mod p$ 当且仅当a是p的二次剩余

提示：假设g是p的原根，并利用“ $g^m$ 是二次剩余当且仅当m是偶数”的结论

假设 $a=g^x$ ，则 $a^{\frac{p-1}{2}}=g^{\frac{x(p-1)}{2}}$ 。如果x是偶数， $\frac{x(p-1)}{2}$ 的结果将是p-1的倍数，进而模p同余1

3. 证明 $a^{\frac{p-1}{2}}\equiv(\frac{a}{p})\mod p$ （即使p|a，此条依然成立）

首先 $a^{\frac{p-1}{2}}$ 模p要么同余1，要么同余-1（1的平方根只有1或者-1）；`2`已经证明了同余1的情况，且“a是二次剩余”是充要条件。因此剩下的同余-1的情况已经自动完成证明了

至于p|a，此时 $(\frac{a}{p})=0$ ，也没什么特别的

4. 用`3`的结论证明 $(\frac{-1}{p})$
- =1,如果 $p\equiv 1\mod 4$
- =-1,如果 $p\equiv 3\mod 4$

$(\frac{-1}{p})=(-1)^{\frac{p-1}{2}}$ 。如果p=4x+1，则 $\frac{p-1}{2}=2x$ 仍然是偶数；但如果p=4x+3， $\frac{p-1}{2}=2x+1$ ，为奇数

## Exercise 3.38

证明二次互反定理（quadratic reciprocity theorem,`Theorem 3.62`）的三个部分等价于以下三个公式，其中p和q是奇素数

(第一个公式是上一题)

2. $(\frac{2}{p})=(-1)^{\frac{p^2-1}{8}}$

没有任何头绪，我上哪去找2和-1的关系啊？

于是问chatgpt，它说可以用高斯引理：

设p是奇素数， $a\in Z,gcd(a,p)=1$ 。令 $r_k\equiv ka\mod p,1\leq k\leq\frac{p-1}{2}$ ，其中每个 $r_k$ 都在区间 $(-\frac{p}{2},\frac{p}{2})$ 内。记n=#{ $k:r_k$ < 0 }（也可以看成比 $\frac{p}{2}$ 大的 $r_k$ 数量），那么 $(\frac{a}{p})=(-1)^n$

在这题的背景下，a=2。那么2k > $\frac{p}{2}\Leftrightarrow k$ > $\frac{p}{4}$ 。接下来我们看n，即大于 $\frac{p}{4}$ ,小于等于 $\frac{p-1}{2}$ 的k的数量： $\frac{p-1}{2}-\lfloor\frac{p}{4}\rfloor$

然后按照全部的四种情况进行分类：
- p=8x+1;4x-2x=2x
- p=8x+7;4x+3-(2x+1)=2x+2
- p=8x+3;4x+1-2x=2x+1
- p=8x+5;4x+2-(2x+1)=2x+1

发现前两个都是偶数，后两个都是奇数。因此 $(\frac{a}{p})$ 在前两个情况下等于1，后两个情况下等于-1

最后看上述结果是否匹配 $\frac{p^2-1}{8}$ 的值：
- $\frac{(8x+1)^2-1}{8}=2x(4x+1)$
- $\frac{(8x+7)^2-1}{8}=2 (4 x + 3) (x + 1)$
- $\frac{(8x+3)^2-1}{8}=(4 x + 1) (2 x + 1)$
- $\frac{(8x+5)^2-1}{8}=(2 x + 1) (4 x + 3)$

结果匹配，完成证明

3. $(\frac{p}{q})(\frac{q}{p})=(-1)^{\frac{p-1}{2}\frac{q-1}{2}}$

花了好几个小时和chatgpt讨论这道题（其实是抄它的结论），结果抄到一半发现chatgpt在中途错了，叫它更正后还是错的，浪费我非常多的时间

去问了deepseek，发现证明这个结论需要一堆乱七八糟的定理，难度似乎不低。于是我再审了一遍题，题目似乎只要求我们证明等价？

设 $a=\frac{p-1}{2},b=\frac{q-1}{2}$ ,目标是证明 $(\frac{p}{q})(\frac{q}{p})=(-1)^{ab}$ 等价于：

$$\left( \frac{p}{q} \right) = 
\begin{cases}
\left( \frac{q}{p} \right), & \text{如果 } p \equiv 1 \pmod{4} \text{ 或 } q \equiv 1 \pmod{4}, \\[6pt]
-\left( \frac{q}{p} \right), & \text{如果 } p \equiv 3 \pmod{4} \text{ 且 } q \equiv 3 \pmod{4}.
\end{cases}$$

很明显需要看ab的奇偶性：
- $p\equiv 1\mod 4\Leftrightarrow a=2k$
- $p\equiv 3\mod 4\Leftrightarrow a=2k+1$
- 对q也是同理
- 所以只要p和q中有一个模4余1， $(-1)^{ab}$ 就是1，对应 $(\frac{p}{q})=(\frac{q}{p})$
- 如果p和q均模4余3， $(-1)^{ab}$ 就是-1，对应 $(\frac{p}{q})=-(\frac{q}{p})$
- （等价严格上需要证明两个方向，但是原理差不多，所以我懒得写了）

## Exercise 3.41

假设p为质数。如果 $p\nmid a$ 且存在整数c满足 $a\equiv c^3\mod p$ ，则称a为模p的立方剩余（cubic residue）

4. 假设 $p\equiv 2\mod 3$ ，证明任何数都是模p的立方剩余

假设g是模p的原根，我们知道任何数都可以表示成 $g^x$ ，x的取值范围是1到p-1。目标是证明对于任意一个x，都有另一个x'，使得 $x\equiv 3x'\mod p-1$

因为p=3k+2，所以p-1=3k+1，有gcd(3,3k+1)=1，因此上述同余方程有解

# Elgamal Digital Signatures and DSA

(这章非常短)

## Exercise 4.7

假设p为质数，i和j均为整数，有gcd(j,p-1)=1；A为任意整数。构造：
- $S_1\equiv g^iA^j\mod p$
- $S_2\equiv -S_1j^{-1}\mod p-1$
- $D\equiv -S_1ij^{-1}\mod p-1$

证明 $(S_1,S_2)$ 是验证密钥（verification key）A下文档D的有效Elgamal签名

证明这类题似乎没啥技巧，就是硬算（

- $A^{S_1}S_1^{S_2}\equiv A^{S_1}(g^iA^j)^{-S_1j^{-1}}\equiv A^{S_1}g^{-S_1ij^{-1}}A^{-S_1jj^{-1}}\equiv g^{-S_1ij^{-1}}\mod p$
- $g^D\equiv g^{-S_1ij^{-1}}\mod p$